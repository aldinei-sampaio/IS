<!DOCTYPE html>
<html>
<head>
    <title>IS Research - Async Choices Scroll</title>
    <link rel="stylesheet" href="is.css" />
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script src="is.js"></script>
</head>
<body>
    <div class="background"></div>

    <div class="root">
        <div class="container">
            <button style="position:absolute;float:left;">Escolha uma opção</button>
            <div class="middle_container">
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(async function () {            
            var button = $("button");
            var container = $(".container");

            var back = new Background($(".background"));
            await back.FadeInAsync("sky", "left");

            var scene;
            var current;
            var read = [false, false, false, false, false, false, false, false, false];

            var steps = [
                async () => {
                    if (scene) {
                        await scene.HideAsync();
                    }

                    scene = new LeftPersonBalloon();
                    back.ProtagAsync();
                    await scene.ShowAsync(container, "emelin", "Emelin");
                    scene.ShowThought();

                    await Task.WaitAll(
                        scene.ShowTextAsync("Texto propositalmente longo para foçar uma quebra de linha no balão."),
                        scene.ShowChoicesAsync(
                            {
                                current: current,
                                choices: [
                                    { key: "1", text: "Opção 1", type: read[0] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "2", text: "Opção 2", type: read[1] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "3", text: "Opção 3", type: read[2] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "4", text: "Opção 4", type: read[3] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "5", text: "Opção 5", type: read[4] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "6", text: "Opção 6", type: read[5] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "7", text: "Opção 7", type: read[6] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "8", text: "Opção 8", type: read[7] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "9", text: "Opção 9", type: read[8] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" }
                                ]
                            },
                            OnChoiceClick
                        )
                    );
                },
                async () => {
                    await scene.ShowTextAsync("Você escolheu a opção " + current + ".");
                    $("body").one("click", OnClick);
                },
                async () => {
                    await scene.HideAsync();

                    scene = new RightPersonBalloon();
                    back.ProtagAsync();
                    await scene.ShowAsync(container, "emelin", "Emelin");
                    scene.ShowThought();

                    await Task.WaitAll(
                        scene.ShowTextAsync("Escolha uma opção..."),
                        scene.ShowChoicesAsync(
                            {
                                current: current,
                                choices: [
                                    { key: "1", text: "Opção 1", type: read[0] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "2", text: "Opção 2", type: read[1] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "3", text: "Opção 3", type: read[2] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "4", text: "Opção 4", type: read[3] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "5", text: "Opção 5", type: read[4] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "6", text: "Opção 6", type: read[5] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "7", text: "Opção 7", type: read[6] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "8", text: "Opção 8", type: read[7] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                    { key: "9", text: "Opção 9", type: read[8] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" }
                                ]
                            },
                            OnChoiceClick
                        )
                    );
                },
                async () => {
                    await scene.ShowTextAsync("Você escolheu a opção " + current + ".");
                    $("body").one("click", OnClick);
                },
                async () => {
                    await scene.HideAsync();

                    scene = new TutorialBalloon();
                    await scene.ShowAsync(container, "Tutorial", "Escolha uma opção...");

                    await scene.ShowChoicesAsync(
                        {
                            current: current,
                            choices: [
                                { key: "1", text: "Opção 1", type: read[0] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "2", text: "Opção 2", type: read[1] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "3", text: "Opção 3", type: read[2] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "4", text: "Opção 4", type: read[3] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "5", text: "Opção 5", type: read[4] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "6", text: "Opção 6", type: read[5] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "7", text: "Opção 7", type: read[6] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "8", text: "Opção 8", type: read[7] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "9", text: "Opção 9", type: read[8] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" }
                            ]
                        },
                        OnChoiceClick
                    );                    
                },
                async () => {
                    await scene.ShowTextAsync("Você escolheu a opção " + current + ".");
                    $("body").one("click", OnClick);
                },
                async () => {
                    await scene.HideAsync();

                    scene = new NarrationBalloon();
                    await scene.ShowAsync(container, "", "Escolha uma opção...");

                    await scene.ShowChoicesAsync(
                        {
                            current: current,
                            choices: [
                                { key: "1", text: "Opção 1", type: read[0] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "2", text: "Opção 2", type: read[1] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "3", text: "Opção 3", type: read[2] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "4", text: "Opção 4", type: read[3] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "5", text: "Opção 5", type: read[4] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "6", text: "Opção 6", type: read[5] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "7", text: "Opção 7", type: read[6] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "8", text: "Opção 8", type: read[7] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" },
                                { key: "9", text: "Opção 9", type: read[8] ? ChoiceType.ICON : ChoiceType.SIMPLE, imageName: "visualized" }
                            ]
                        },
                        OnChoiceClick
                    );
                },
                async () => {
                    await scene.ShowTextAsync("Você escolheu a opção " + current + ".");
                    $("body").one("click", OnClick);
                }
            ];

            var n = 0;

            async function OnClick() {
                var sceneId = NextScene();
                button.text("Step " + sceneId + " started");
                await steps[sceneId]();
                button.text("Step " + sceneId + " ended");
            }

            function NextScene() {
                var oldValue = n;
                if (++n >= steps.length) {
                    n = 0;
                }
                return oldValue;
            }

            function OnChoiceClick(choice) {
                current = choice.key;
                read[parseInt(current) - 1] = true;
                OnClick();
            }

            OnClick();
        });
    </script>
</body>
</html>